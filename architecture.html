<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MattGPT - Two-Track Architecture Documentation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="darkmode-toggle" id="darkmode-toggle" aria-label="Toggle dark mode">
                <span id="darkmode-icon">🌙</span>
            </button>
            <div class="header-text">
                <h1>MattGPT</h1>
                <p>Two-Track Architecture Documentation</p>
            </div>
        </div>

        <div class="tab-nav">
            <button class="tab-button active" onclick="showTab('overview')">
                🚀 Architecture Overview
            </button>
            <button class="tab-button" onclick="showTab('tracks')">
                🔄 Two-Track System
            </button>
            <button class="tab-button" onclick="showTab('chain')">
                🔗 Chain Operations
            </button>
            <button class="tab-button" onclick="showTab('chat')">
                💬 Enhanced Chat
            </button>
            <button class="tab-button" onclick="showTab('technical')">
                🏗️ Technical Details
            </button>
        </div>

        <!-- ARCHITECTURE OVERVIEW TAB -->
        <div id="overview" class="tab-content active">
            <div class="section">
                <h2>🚀 MattGPT Two-Track Architecture Overview</h2>
                
                <div class="workflow-grid">
                    <div class="workflow-card">
                        <div class="workflow-title">🧠 Local AI Foundation</div>
                        <div class="workflow-description">
                            Powered by IBM's Granite 3.2:8b model running locally via Ollama, providing complete privacy and no cloud dependencies for all AI operations.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🏗️ Separation of Concerns</div>
                        <div class="workflow-description">
                            Two-Track Architecture separates complex automated workflows from conversational interactions, preventing interference and enabling specialized optimization.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">📊 Data Processing Pipeline</div>
                        <div class="workflow-description">
                            Multi-source content curation from RSS feeds, web scraping, and PDF processing with AI-powered relevance scoring and hot topics detection.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🎙️ Content Generation</div>
                        <div class="workflow-description">
                            Edge-TTS voice synthesis creates daily podcasts with dual speaker personalities, intelligent script generation, and audio assembly.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">👥 Customer Intelligence</div>
                        <div class="workflow-description">
                            CSV-based customer database with cluster organization, reference materials caching, and intelligent research insights generation.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">📈 Analytics & Visualization</div>
                        <div class="workflow-description">
                            D3.js-powered word clouds, trend analysis, keyword frequency tables, and comprehensive weekly review generation.
                        </div>
                    </div>
                </div>

                <h3>🎯 Core System Capabilities</h3>
                <div class="flow-diagram">
                    <div class="workflow-step">
                        <div class="step-title">Local-First Architecture</div>
                        <div class="step-description">Complete system runs locally with no cloud dependencies, ensuring privacy and control over all data processing</div>
                    </div>
                    
                    <div class="workflow-step">
                        <div class="step-title">Modular Component Design</div>
                        <div class="step-description">Independent modules for content curation, current events analysis, chat assistance, and customer management</div>
                    </div>
                    
                    <div class="workflow-step">
                        <div class="step-title">Intelligent Progress Tracking</div>
                        <div class="step-description">Real-time progress monitoring across all operations with detailed phase information and completion status</div>
                    </div>
                    
                    <div class="workflow-step">
                        <div class="step-title">Flexible Configuration</div>
                        <div class="step-description">JSON-based configuration for RSS sources, search providers, interests, and analysis parameters</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TWO-TRACK SYSTEM TAB -->
        <div id="tracks" class="tab-content">
            <div class="section">
                <h2>🔄 Two-Track System Architecture</h2>
                
                <h3>🎯 Architecture Philosophy</h3>
                <p style="color: var(--neutral-600); margin-bottom: 30px;">
                    The Two-Track Architecture implements complete separation of concerns between complex automated workflows and conversational interactions, preventing interference while enabling specialized optimization for each use case.
                </p>

                <div class="workflow-grid">
                    <div class="workflow-card">
                        <div class="workflow-title">🔗 Track 1: Chain Operations</div>
                        <div class="workflow-description">
                            <strong>Purpose:</strong> Complex automated workflows<br>
                            <strong>Trigger:</strong> Button-driven operations<br>
                            <strong>Examples:</strong> "What's Going On?", Week in Review, Daily Podcast<br>
                            <strong>Features:</strong> Progress tracking, multi-step orchestration, result modals
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">💬 Track 2: Enhanced Chat</div>
                        <div class="workflow-description">
                            <strong>Purpose:</strong> Conversational interactions<br>
                            <strong>Trigger:</strong> Text input and messaging<br>
                            <strong>Examples:</strong> Article discussions, URL analysis, customer queries<br>
                            <strong>Features:</strong> Session management, context awareness, streaming responses
                        </div>
                    </div>
                </div>

                <h3>🔄 Track Interaction Patterns</h3>
                <div class="flow-diagram">
                    <div class="workflow-step start">
                        <div class="step-title">User Interface Layer</div>
                        <div class="step-description">Single UI routes interactions to appropriate track based on input type</div>
                        <div class="step-details">Button clicks → Chain Operations / Text input → Enhanced Chat</div>
                    </div>

                    <div class="workflow-step decision">
                        <div class="step-title">Request Classification</div>
                        <div class="step-description">Intelligent routing determines which track should handle the request</div>
                        <div class="step-details">Intent detection, session context, and operation type analysis</div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-title">Track 1: Chain Operations Manager</div>
                        <div class="step-description">Handles complex workflows with direct module orchestration</div>
                        <div class="step-details">Direct API calls to content curator, current events analyzer, podcast generator</div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-title">Track 2: Enhanced Chat Manager</div>
                        <div class="step-description">Manages conversational interactions with session state</div>
                        <div class="step-details">Article context, customer database queries, URL analysis, PDF processing</div>
                    </div>

                    <div class="workflow-step end">
                        <div class="step-title">Response Formatting</div>
                        <div class="step-description">Track-specific response formatting and delivery to frontend</div>
                        <div class="step-details">Chain: Progress tracking + Modals / Chat: Streaming responses + Context</div>
                    </div>
                </div>

                <h3>🎯 Track Isolation Benefits</h3>
                <div class="workflow-grid">
                    <div class="workflow-card">
                        <div class="workflow-title">⚡ Performance Optimization</div>
                        <div class="workflow-description">
                            Each track optimized for its specific use case without interference from the other track's operations or state management.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🔄 Independent Scaling</div>
                        <div class="workflow-description">
                            Chain operations can handle long-running workflows while chat maintains responsiveness for immediate interactions.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🛡️ Error Isolation</div>
                        <div class="workflow-description">
                            Failures in one track don't affect the other, ensuring system stability and graceful degradation.
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🔧 Simplified Debugging</div>
                        <div class="workflow-description">
                            Clear separation makes it easier to troubleshoot issues and implement new features without cross-track interference.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CHAIN OPERATIONS TAB -->
        <div id="chain" class="tab-content">
            <div class="section">
                <h2>🔗 Chain Operations Track</h2>
                
                <h3>🎯 Chain Operations Manager</h3>
                <p style="color: var(--neutral-600); margin-bottom: 30px;">
                    The Chain Operations Manager provides direct orchestration of complex workflows without research assistant dependency. It manages multi-step operations with progress tracking and result delivery.
                </p>

                <div class="workflow-grid">
                    <div class="workflow-card">
                        <div class="workflow-title">🔍 "What's Going On?" Workflow</div>
                        <div class="workflow-description">
                            <strong>Steps:</strong> Current events analysis → Hot topics detection → Article collection → Relevance scoring<br>
                            <strong>Output:</strong> Ranked articles with boost scores and trending topics modal<br>
                            <strong>Features:</strong> Force refresh option, existing data detection
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">📊 Week in Review Generation</div>
                        <div class="workflow-description">
                            <strong>Steps:</strong> File discovery → Data parsing → LLM consolidation → Visualization<br>
                            <strong>Output:</strong> D3.js word clouds, keyword frequency tables, comprehensive summaries<br>
                            <strong>Features:</strong> 7-day analysis, caching, print-friendly format
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🎙️ Daily Podcast Creation</div>
                        <div class="workflow-description">
                            <strong>Steps:</strong> Article selection → Script generation → Voice synthesis → Audio assembly<br>
                            <strong>Output:</strong> MP3 podcast with dual speaker dialogue (Alex & Sam)<br>
                            <strong>Features:</strong> Edge-TTS integration, fallback options, metadata generation
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🔄 Force Content Refresh</div>
                        <div class="workflow-description">
                            <strong>Steps:</strong> Source validation → Content collection → AI analysis → Database update<br>
                            <strong>Output:</strong> Fresh content with updated relevance scores<br>
                            <strong>Features:</strong> Configurable timeframe, selective refresh options
                        </div>
                    </div>
                </div>

                <h3>🔗 Chain Operation Flow</h3>
                <div class="interactive-section">
                    <button class="play-button" onclick="startChainAnimation()">▶️ View Chain Operation Animation</button>
                </div>

                <div class="chain-animation" id="chainAnimation">
                    <div class="chain-step" id="step1">
                        <div class="chain-icon">🚀</div>
                        <div class="chain-content">
                            <div class="chain-title">Operation Initialization</div>
                            <div class="chain-desc">Create session, check existing data, initialize progress tracking</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step2">
                        <div class="chain-icon">🔍</div>
                        <div class="chain-content">
                            <div class="chain-title">Current Events Analysis</div>
                            <div class="chain-desc">RSS feed collection, headline analysis, hot topics detection</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step3">
                        <div class="chain-icon">📰</div>
                        <div class="chain-content">
                            <div class="chain-title">Content Collection</div>
                            <div class="chain-desc">Multi-source article gathering, web scraping, content extraction</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step4">
                        <div class="chain-icon">🤖</div>
                        <div class="chain-content">
                            <div class="chain-title">AI Processing</div>
                            <div class="chain-desc">Granite 3.2 analysis, summarization, relevance scoring</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step5">
                        <div class="chain-icon">🔥</div>
                        <div class="chain-content">
                            <div class="chain-title">Hot Topics Boost</div>
                            <div class="chain-desc">Apply trending topic scores to enhance article rankings</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step6">
                        <div class="chain-icon">📊</div>
                        <div class="chain-content">
                            <div class="chain-title">Results Compilation</div>
                            <div class="chain-desc">Generate modal content, prepare downloads, update progress</div>
                        </div>
                    </div>

                    <div class="chain-step" id="step7">
                        <div class="chain-icon">✅</div>
                        <div class="chain-content">
                            <div class="chain-title">Delivery Complete</div>
                            <div class="chain-desc">Present results in interactive modal with filtering and chat options</div>
                        </div>
                    </div>
                </div>

                <h3>🔧 API Endpoints</h3>
                <div class="endpoint-box">
                    <span class="method-badge method-post">POST</span>
                    <strong>/api/chain/whats-going-on</strong>
                    <div style="margin-top: 8px; color: var(--neutral-600);">Start "What's Going On?" analysis with optional force refresh</div>
                </div>

                <div class="endpoint-box">
                    <span class="method-badge method-post">POST</span>
                    <strong>/api/chain/week-review</strong>
                    <div style="margin-top: 8px; color: var(--neutral-600);">Generate comprehensive week in review with D3.js visualizations</div>
                </div>

                <div class="endpoint-box">
                    <span class="method-badge method-post">POST</span>
                    <strong>/api/chain/podcast</strong>
                    <div style="margin-top: 8px; color: var(--neutral-600);">Create daily podcast with Edge-TTS voice synthesis</div>
                </div>

                <div class="endpoint-box">
                    <span class="method-badge method-get">GET</span>
                    <strong>/api/chain/progress/{session_id}</strong>
                    <div style="margin-top: 8px; color: var(--neutral-600);">Get real-time progress updates for chain operations</div>
                </div>
            </div>
        </div>

        <!-- ENHANCED CHAT TAB -->
        <div id="chat" class="tab-content">
            <div class="section">
                <h2>💬 Enhanced Chat Track</h2>
                
                <h3>🧠 Enhanced Chat Manager</h3>
                <p style="color: var(--neutral-600); margin-bottom: 30px;">
                    The Enhanced Chat Manager provides stateful conversational interactions with advanced context awareness, session management, and specialized capabilities for article discussion and customer database queries.
                </p>

                <div class="workflow-grid">
                    <div class="workflow-card">
                        <div class="workflow-title">💬 Session Management</div>
                        <div class="workflow-description">
                            <strong>Features:</strong> Persistent session state, conversation history, context preservation<br>
                            <strong>Database:</strong> SQLite session storage with activity tracking<br>
                            <strong>Lifecycle:</strong> Auto-cleanup, timeout handling, context switching
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">📰 Article Discussions</div>
                        <div class="workflow-description">
                            <strong>Features:</strong> Article context injection, relevance-based selection, intelligent responses<br>
                            <strong>Capabilities:</strong> Summarization, key points extraction, follow-up questions<br>
                            <strong>Integration:</strong> Direct database article access, metadata utilization
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">🌐 URL Analysis</div>
                        <div class="workflow-description">
                            <strong>Features:</strong> Web scraping, PDF processing, content extraction<br>
                            <strong>Supported:</strong> Web pages, PDF documents, academic papers<br>
                            <strong>Processing:</strong> Multi-library PDF support, graceful fallbacks
                        </div>
                    </div>
                    
                    <div class="workflow-card">
                        <div class="workflow-title">👥 Customer Intelligence</div>
                        <div class="workflow-description">
                            <strong>Features:</strong> Customer database queries, cluster analysis, research insights<br>
                            <strong>Data Source:</strong> CSV-based customer management with cache integration<br>
                            <strong>Capabilities:</strong> Fuzzy matching, multi-step workflows, battle card generation
                        </div>
                    </div>
                </div>

                <h3>🎯 Chat Intent Detection</h3>
                <div class="flow-diagram">
                    <div class="workflow-step start">
                        <div class="step-title">Message Analysis</div>
                        <div class="step-description">Parse user input for intent patterns and context clues</div>
                        <div class="step-details">Database search patterns, article references, customer keywords</div>
                    </div>

                    <div class="workflow-step decision">
                        <div class="step-title">Intent Classification</div>
                        <div class="step-description">Determine appropriate response strategy based on detected intent</div>
                        <div class="step-details">Article discussion, database search, URL analysis, customer management</div>
                    </div>

                    <div class="workflow-step">
                        <div class="step-title">Context Enrichment</div>
                        <div class="step-description">Gather relevant context data for enhanced responses</div>
                        <div class="step-details">Article content, customer data, URL processing, session history</div>
                    </div>

                    <div class="workflow-step end">
                        <div class="step-title">Response Generation</div>
                        <div class="step-description">Generate contextually aware response using Granite 3.2</div>
                        <div class="step-details">Streaming responses, follow-up suggestions, action recommendations</div>
                    </div>
                </div>

                <h3>🔧 Enhanced Chat Features</h3>
                <div class="interactive-section">
                    <div class="expandable component-card" onclick="toggleExpand(this)">
                        <div class="component-title">📊 Database Integration</div>
                        <div class="expandable-content">
                            <strong>Article Cross-Reference:</strong>
                            <ul>
                                <li>Full-text search across article database</li>
                                <li>Relevance-based article recommendations</li>
                                <li>Metadata-driven content selection</li>
                                <li>Smart article discussion initiation</li>
                            </ul>
                        </div>
                    </div>

                    <div class="expandable component-card" onclick="toggleExpand(this)">
                        <div class="component-title">👥 Customer Management</div>
                        <div class="expandable-content">
                            <strong>Advanced Customer Intelligence:</strong>
                            